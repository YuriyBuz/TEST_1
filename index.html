<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç: –ü–∞—Å–ø–æ—Ä—Ç –Ø–∫–æ—Å—Ç—ñ (FSSC 22000 v6)</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- QR Code Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        :root {
            --bg-color: #f8fafc;
            --card-bg: #ffffff;
            --text-main: #1e293b;
            --text-muted: #64748b;
            --primary: #059669; /* Emerald 600 */
            --danger: #dc2626; /* Red 600 */
        }
        body { background-color: var(--bg-color); color: var(--text-main); font-family: sans-serif; padding-bottom: 2rem; }
        .card { background-color: var(--card-bg); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .option-btn { transition: all 0.2s; border: 2px solid #e2e8f0; }
        .option-btn:hover { border-color: var(--primary); background-color: #f0fdf4; }
        .option-btn.selected { border-color: var(--primary); background-color: #d1fae5; font-weight: bold; }
        .hidden { display: none !important; }
        
        #qrcode img {
            margin: 0 auto;
            border: 4px solid white;
            border-radius: 8px;
        }
    </style>
</head>
<body class="bg-slate-50 min-h-screen">

    <div class="container mx-auto max-w-2xl p-4">
        
        <!-- Header -->
        <header class="text-center mb-6 pt-4">
            <img src="https://foodline-production.com/wp-content/uploads/2021/10/3752781497_3752781497.webp" alt="Logo" class="w-24 h-auto mx-auto mb-4 rounded-lg">
            <h1 class="text-3xl font-bold text-emerald-800">–ü–∞—Å–ø–æ—Ä—Ç –Ø–∫–æ—Å—Ç—ñ</h1>
            <p class="text-slate-500 mt-2">–í–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–æ —Å–æ—É—Å—ñ–≤ | FSSC 22000 v6</p>
        </header>

        <!-- Step 1: Login & Intro -->
        <div id="step-login" class="card p-6 rounded-2xl">
            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-6">
                <h3 class="font-bold text-blue-800">–£–º–æ–≤–∏ "Quality Bonus":</h3>
                <p class="text-sm text-blue-700 mt-1">
                    –£ —Ç–µ—Å—Ç—ñ <strong>26 –ø–∏—Ç–∞–Ω—å</strong> –ø—ñ–¥–≤–∏—â–µ–Ω–æ—ó —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ.
                    –ü—Ä–æ—Ö—ñ–¥–Ω–∏–π –±–∞–ª: <strong>24 –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ</strong> (92%), 
                    —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ <strong>+5% –¥–æ —Ç–∞—Ä–∏—Ñ—É</strong>!
                </p>
            </div>

            <label class="block text-sm font-bold mb-2">–ü—Ä—ñ–∑–≤–∏—â–µ —Ç–∞ —ñ–º'—è –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞:</label>
            <input type="text" id="employeeName" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –Ü–≤–∞–Ω–æ–≤ –ü–µ—Ç—Ä–æ" class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 mb-6 text-lg">
            
            <button onclick="startTest()" class="w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3 rounded-xl shadow-lg transition transform active:scale-95">
                –†–û–ó–ü–û–ß–ê–¢–ò –¢–ï–°–¢
            </button>
        </div>

        <!-- Step 2: Quiz -->
        <div id="step-quiz" class="hidden">
            <div class="flex justify-between items-center mb-4 px-2">
                <span class="text-sm font-bold text-slate-500">–ü–∏—Ç–∞–Ω–Ω—è <span id="q-current">1</span> –∑ <span id="q-total">26</span></span>
                <div class="w-1/2 bg-gray-200 rounded-full h-2.5">
                    <div id="progress-bar" class="bg-emerald-600 h-2.5 rounded-full" style="width: 0%"></div>
                </div>
            </div>

            <div class="card p-6 rounded-2xl min-h-[300px] flex flex-col justify-between">
                <div>
                    <h2 id="question-text" class="text-xl font-bold mb-6 text-slate-800 leading-snug"></h2>
                    <div id="options-container" class="space-y-3">
                        <!-- Options will be injected here -->
                    </div>
                </div>
                
                <button id="next-btn" onclick="nextQuestion()" disabled class="mt-6 w-full bg-gray-300 text-gray-500 font-bold py-3 rounded-xl cursor-not-allowed transition">
                    –î–∞–ª—ñ
                </button>
            </div>
        </div>

        <!-- Step 3: Results -->
        <div id="step-result" class="hidden text-center">
            <div class="card p-8 rounded-2xl">
                <div id="icon-result" class="text-6xl mb-4"></div>
                <h2 id="title-result" class="text-3xl font-bold mb-2"></h2>
                
                <div class="py-4 my-4 border-t border-b border-gray-100">
                    <p class="text-slate-500 text-sm">–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</p>
                    <p class="text-4xl font-black text-slate-800"><span id="score-val">0</span> / 26</p>
                    <p id="percentage-val" class="text-lg font-semibold mt-1"></p>
                </div>

                <p id="msg-result" class="text-lg mb-6 px-4"></p>

                <!-- QR Code Container -->
                <div class="mb-6">
                    <p class="text-sm text-slate-500 mb-2">QR-–∫–æ–¥ –∑ –¥–µ—Ç–∞–ª—è–º–∏ –¥–ª—è –∫–µ—Ä—ñ–≤–Ω–∏–∫–∞ (–Ω–∞ –µ–∫—Ä–∞–Ω—ñ):</p>
                    <div id="qrcode" class="flex justify-center"></div>
                </div>

                <div class="space-y-3">
                    <a id="email-btn" href="#" class="block w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3 rounded-xl shadow-lg transition">
                        üìß –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –∑–≤—ñ—Ç (Email)
                    </a>
                    
                    <button onclick="location.reload()" class="block w-full text-slate-400 text-sm underline pt-2">
                        –ü—Ä–æ–π—Ç–∏ —â–µ —Ä–∞–∑
                    </button>
                </div>
            </div>
        </div>

    </div>

    <script>
        // DATA: Questions (FSSC 22000 v6, Sauce Production Context)
        const questions = [
            {
                q: "–ö—É–ª—å—Ç—É—Ä–∞ –±–µ–∑–ø–µ–∫–∏ (FSSC 22000): –í–∏ –ø–æ–º—ñ—Ç–∏–ª–∏, —â–æ –∫–æ–ª–µ–≥–∞ –Ω–µ –∑–º—ñ–Ω–∏–≤ —Ä—É–∫–∞–≤–∏—á–∫–∏ –ø—ñ—Å–ª—è –ø—ñ–¥–Ω—è—Ç—Ç—è –ø—Ä–µ–¥–º–µ—Ç–∞ –∑ –ø—ñ–¥–ª–æ–≥–∏. –í–∞—à—ñ –¥—ñ—ó?",
                a: ["–ü—Ä–æ—ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏, —â–æ–± –Ω–µ —Å–≤–∞—Ä–∏—Ç–∏—Å—è", "–ó—Ä–æ–±–∏—Ç–∏ –∑–∞—É–≤–∞–∂–µ–Ω–Ω—è –∫–æ–ª–µ–∑—ñ —Ç–∞ –ø–æ–≤—ñ–¥–æ–º–∏—Ç–∏ –º–∞–π—Å—Ç—Ä–∞, —è–∫—â–æ —Ä–µ–∞–∫—Ü—ñ—ó –Ω–µ–º–∞—î", "–ó–º—ñ–Ω–∏—Ç–∏ —Ä—É–∫–∞–≤–∏—á–∫–∏ –∑–∞ –Ω—å–æ–≥–æ"],
                correct: 1
            },
            {
                q: "–ö—Ä–∏—Ç–∏—á–Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞ —Ç–æ—á–∫–∞: –ü—ñ–¥ —á–∞—Å –ø–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü—ñ—ó —Å–æ—É—Å—É —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤–ø–∞–ª–∞ –Ω–∏–∂—á–µ –∫—Ä–∏—Ç–∏—á–Ω–æ—ó –º–µ–∂—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –Ω–∏–∂—á–µ 90¬∞C). –í–∞—à—ñ –¥—ñ—ó?",
                a: ["–ó–±—ñ–ª—å—à–∏—Ç–∏ –ø–∞—Ä —ñ –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏", "–ó—É–ø–∏–Ω–∏—Ç–∏ –ø—Ä–æ—Ü–µ—Å, –∑–∞–±–ª–æ–∫—É–≤–∞—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç (–∫–∞—Ä–∞–Ω—Ç–∏–Ω), –ø–æ–≤—ñ–¥–æ–º–∏—Ç–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∞", "–ó–∞–ø–∏—Å–∞—Ç–∏ –≤ –∂—É—Ä–Ω–∞–ª, —â–æ–± –Ω–µ –∑—É–ø–∏–Ω—è—Ç–∏ –ª—ñ–Ω—ñ—é"],
                correct: 1
            },
            {
                q: "–ê–ª–µ—Ä–≥–µ–Ω–∏: –í–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∑ –≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–∞ '–ì—ñ—Ä—á–∏—á–Ω–æ–≥–æ' —Å–æ—É—Å—É –Ω–∞ '–¢–æ–º–∞—Ç–Ω–∏–π'. –Ø–∫–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ —î –æ–±–æ–≤'—è–∑–∫–æ–≤–æ—é?",
                a: ["–ü—Ä–æ—Å—Ç–æ –∑–ª–∏—Ç–∏ –∑–∞–ª–∏—à–∫–∏ –≥—ñ—Ä—á–∏—Ü—ñ", "–ü—Ä–æ–≤–µ—Å—Ç–∏ –ø–æ–≤–Ω—É —Å–∞–Ω—ñ—Ç–∞—Ä–Ω—É –º–∏–π–∫—É –æ–±–ª–∞–¥–Ω–∞–Ω–Ω—è (CIP) –∑ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º —è–∫–æ—Å—Ç—ñ –º–∏—Ç—Ç—è", "–ü—Ä–æ–º–∏–≤–∞—Ç–∏ –≤–æ–¥–æ—é 5 –≥–æ–¥–∏–Ω"],
                correct: 1
            },
            {
                q: "–°—Ç–æ—Ä–æ–Ω–Ω—ñ –ø—Ä–µ–¥–º–µ—Ç–∏: –í–∏ –≤–∏—è–≤–∏–ª–∏, —â–æ —Å–∏—Ç–æ –¥–ª—è –ø—Ä–æ—Å—ñ—é–≤–∞–Ω–Ω—è –ø–æ—à–∫–æ–¥–∂–µ–Ω–µ (—î –¥—ñ—Ä–∫–∞). –©–æ —Ä–æ–±–∏—Ç–∏ –∑ –ø–∞—Ä—Ç—ñ—î—é, —è–∫–∞ –ø—Ä–æ–π—à–ª–∞ —á–µ—Ä–µ–∑ –Ω—å–æ–≥–æ?",
                a: ["–í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –¥–∞–ª—ñ, –¥—ñ—Ä–∫–∞ –º–∞–ª–µ–Ω—å–∫–∞", "–ü–∞—Ä—Ç—ñ—é —ñ–∑–æ–ª—é–≤–∞—Ç–∏ —è–∫ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –Ω–µ–±–µ–∑–ø–µ—á–Ω—É, —Å–∏—Ç–æ –∑–∞–º—ñ–Ω–∏—Ç–∏", "–ó–∞–º—ñ–Ω–∏—Ç–∏ —Å–∏—Ç–æ, –∞ –ø—Ä–æ–¥—É–∫—Ç –ø—É—Å—Ç–∏—Ç–∏ —É –≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–æ"],
                correct: 1
            },
            {
                q: "–°–∫–ª–æ –Ω–∞ –≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤—ñ: –£ —Ü–µ—Ö—É –ø—Ä–∏–≥–æ—Ç—É–≤–∞–Ω–Ω—è —Å–æ—É—Å—ñ–≤ —Ä–æ–∑–±–∏–ª–∞—Å—è —Å–∫–ª—è–Ω–∞ –ø–ª—è—à–∫–∞ –∑ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–æ–º. –Ø–∫–∞ –∑–æ–Ω–∞ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ–≥–æ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è?",
                a: ["–¢—ñ–ª—å–∫–∏ –º—ñ—Å—Ü–µ –ø–∞–¥—ñ–Ω–Ω—è", "–†–∞–¥—ñ—É—Å –º—ñ–Ω—ñ–º—É–º 3-5 –º–µ—Ç—Ä—ñ–≤, –≤—Å—è –≤—ñ–¥–∫—Ä–∏—Ç–∞ –ø—Ä–æ–¥—É–∫—Ü—ñ—è –≤ —Ü—å–æ–º—É —Ä–∞–¥—ñ—É—Å—ñ –≤–≤–∞–∂–∞—î—Ç—å—Å—è –±—Ä–∞–∫–æ–º", "–¢—ñ–ª—å–∫–∏ –ø—ñ–¥–ª–æ–≥–∞"],
                correct: 1
            },
            {
                q: "–ó–∞—Ö–∏—Å—Ç —ó–∂—ñ: –í–∏ –±–∞—á–∏—Ç–µ –Ω–µ–∑–Ω–∞–π–æ–º—É –ª—é–¥–∏–Ω—É –±–µ–∑ —Å—É–ø—Ä–æ–≤–æ–¥—É –±—ñ–ª—è —î–º–Ω–æ—Å—Ç–µ–π –∑ –≥–æ—Ç–æ–≤–∏–º –ø—Ä–æ–¥—É–∫—Ç–æ–º. –í–∞—à—ñ –¥—ñ—ó?",
                a: ["–ó–∞–ø–∏—Ç–∞—Ç–∏ '–•—Ç–æ –≤–∏?' —ñ —Å—É–ø—Ä–æ–≤–æ–¥–∏—Ç–∏ –¥–æ –≤–∏—Ö–æ–¥—É —ñ –ø–æ–∫–ª–∏–∫–∞—Ç–∏ –ú–∞–π—Å—Ç—Ä–∞ –∑–º—ñ–Ω–∏", "–ü—Ä–æ–π—Ç–∏ –ø–æ–≤–∑, –º–∞–±—É—Ç—å —Ü–µ –Ω–æ–≤–∏–π —Å–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫", "–ü—Ä–∏–≤—ñ—Ç–∞—Ç–∏—Å—è —ñ –ø–æ–±–∞–∂–∞—Ç–∏ —Ö–æ—Ä–æ—à–æ–≥–æ –¥–Ω—è"],
                correct: 0
            },
            {
                q: "–®–∞—Ö—Ä–∞–π—Å—Ç–≤–æ: –ù–∞ —Å–∫–ª–∞–¥ –Ω–∞–¥—ñ–π—à–ª–∞ —Å–∏—Ä–æ–≤–∏–Ω–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø–∞–ø—Ä–∏–∫–∞) –±–µ–∑ –º–∞—Ä–∫—É–≤–∞–Ω–Ω—è —Ç–∞ –Ω–æ–º–µ—Ä—É –ø–∞—Ä—Ç—ñ—ó. –ß–∏ –º–æ–∂–Ω–∞ —ó—ó –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏?",
                a: ["–¢–∞–∫, —è–∫—â–æ –≤–æ–Ω–∞ –≤–∏–≥–ª—è–¥–∞—î —è–∫ –ø–∞–ø—Ä–∏–∫–∞", "–ù—ñ, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –Ω–µ—ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ—ó —Å–∏—Ä–æ–≤–∏–Ω–∏ —Å—É–≤–æ—Ä–æ –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ", "–ú–æ–∂–Ω–∞, —è–∫—â–æ –º–∞–π—Å—Ç–µ—Ä –¥–æ–∑–≤–æ–ª–∏—Ç—å"],
                correct: 1
            },
            {
                q: "–û—Å–æ–±–∏—Å—Ç–∞ –≥—ñ–≥—ñ—î–Ω–∞: –ß–æ–º—É –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ª–∞–∫ –¥–ª—è –Ω—ñ–≥—Ç—ñ–≤ –∞–±–æ –Ω–∞–∫–ª–∞–¥–Ω—ñ –≤—ñ—ó –Ω–∞ –≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤—ñ —Å–æ—É—Å—ñ–≤?",
                a: ["–¶–µ –Ω–µ–∫—Ä–∞—Å–∏–≤–æ", "–¶–µ —Ä–∏–∑–∏–∫ –ø–æ—Ç—Ä–∞–ø–ª—è–Ω–Ω—è —Ñ—ñ–∑–∏—á–Ω–æ–≥–æ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è (—à–º–∞—Ç–æ—á–∫—ñ–≤ –ª–∞–∫—É/–≤—ñ–π) —É –≥–æ—Ç–æ–≤–∏–π –ø—Ä–æ–¥—É–∫—Ç", "–¶–µ –≤—ñ–¥–≤–æ–ª—ñ–∫–∞—î –≤—ñ–¥ —Ä–æ–±–æ—Ç–∏"],
                correct: 1
            },
            {
                q: "–ú–∏—Ç—Ç—è —Ä—É–∫: –ü—ñ—Å–ª—è —è–∫–æ—ó –¥—ñ—ó –º–∏—Ç—Ç—è —Ä—É–∫ —î –∫—Ä–∏—Ç–∏—á–Ω–æ –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–º?",
                a: ["–ü—ñ—Å–ª—è –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–Ω—è —Ç—É–∞–ª–µ—Ç—É, —Ä–æ–±–æ—Ç–∏ –∑ –≤—ñ–¥—Ö–æ–¥–∞–º–∏, —Ç–æ—Ä–∫–∞–Ω–Ω—è –¥–æ –æ–±–ª–∏—á—á—è", "–¢—ñ–ª—å–∫–∏ –ø–µ—Ä–µ–¥ –ø–æ—á–∞—Ç–∫–æ–º –∑–º—ñ–Ω–∏", "–¢—ñ–ª—å–∫–∏ —è–∫—â–æ —Ä—É–∫–∏ –≤—ñ–∑—É–∞–ª—å–Ω–æ –±—Ä—É–¥–Ω—ñ"],
                correct: 0
            },
            {
                q: "–ü–µ—Ä–µ—Ö—Ä–µ—Å–Ω–µ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è: –ß–∏ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤—ñ–¥—Ä–æ –¥–ª—è '–°–∞–Ω—ñ—Ç–∞—Ä–Ω–æ–≥–æ –±—Ä–∞–∫—É' —â–æ–± –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ —á–∏—Å—Ç—É –≤–æ–¥—É?",
                a: ["–¢–∞–∫, —è–∫—â–æ –π–æ–≥–æ –ø–æ–º–∏—Ç–∏", "–ù—ñ, —ñ–Ω–≤–µ–Ω—Ç–∞—Ä –ø–æ–≤–∏–Ω–µ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è —Å—É–≤–æ—Ä–æ –∑–∞ –∫–æ–¥—É–≤–∞–Ω–Ω—è–º (–∫–æ–ª—å–æ—Ä–æ–º/–º–∞—Ä–∫—É–≤–∞–Ω–Ω—è–º)", "–ú–æ–∂–Ω–∞ –æ–¥–∏–Ω —Ä–∞–∑"],
                correct: 1
            },
            {
                q: "–ó–¥–æ—Ä–æ–≤'—è –ø–µ—Ä—Å–æ–Ω–∞–ª—É: –£ –≤–∞—Å –¥—ñ–∞—Ä–µ—è, –∞–ª–µ –Ω–µ–º–∞—î —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∏. –ß–∏ –º–æ–∂–Ω–∞ –≤–∏—Ö–æ–¥–∏—Ç–∏ –Ω–∞ –∑–º—ñ–Ω—É –≤ —Ü–µ—Ö –ø—Ä–∏–≥–æ—Ç—É–≤–∞–Ω–Ω—è —ó–∂—ñ?",
                a: ["–¢–∞–∫, —è–∫—â–æ –ø—Ä–∏–π–Ω—è—Ç–∏ –ª—ñ–∫–∏", "–ù—ñ, –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –ø–æ–≤—ñ–¥–æ–º–∏—Ç–∏ –∫–µ—Ä—ñ–≤–Ω–∏–∫–∞ —ñ –Ω–µ –∫–æ–Ω—Ç–∞–∫—Ç—É–≤–∞—Ç–∏ –∑ –ø—Ä–æ–¥—É–∫—Ç–æ–º", "–¢–∞–∫, —è–∫—â–æ —á–∞—Å—Ç–æ –º–∏—Ç–∏ —Ä—É–∫–∏"],
                correct: 1
            },
            {
                q: "–†—É—á–Ω–∞ –º–∏–π–∫–∞ (–ó–∞–º—ñ–Ω–∞ CIP): –í–∏ –º–∏—î—Ç–µ –æ–±–ª–∞–¥–Ω–∞–Ω–Ω—è –≤—Ä—É—á–Ω—É. –ß–∏ –¥–æ–∑–≤–æ–ª–µ–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –º–µ—Ç–∞–ª–µ–≤—ñ —à–∫—Ä–µ–±–∫–∏ –∞–±–æ –∫—É—Ö–æ–Ω–Ω—ñ –≥—É–±–∫–∏?",
                a: ["–¢–∞–∫, –≤–æ–Ω–∏ –∫—Ä–∞—â–µ –≤—ñ–¥–º–∏–≤–∞—é—Ç—å –ø—Ä–∏–≥–∞—Ä", "–ù—ñ, –∫–∞—Ç–µ–≥–æ—Ä–∏—á–Ω–æ –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ (—Ä–∏–∑–∏–∫ –ø–æ—Ç—Ä–∞–ø–ª—è–Ω–Ω—è —à–º–∞—Ç–æ—á–∫—ñ–≤ –º–µ—Ç–∞–ª—É/–≥—É–±–∫–∏ –≤ —Å–æ—É—Å)", "–ú–æ–∂–Ω–∞, —è–∫—â–æ –Ω—ñ—Ö—Ç–æ –Ω–µ –±–∞—á–∏—Ç—å"],
                correct: 1
            },
            {
                q: "–¢–∏–º—á–∞—Å–æ–≤–∏–π —Ä–µ–º–æ–Ω—Ç: –ß–∏ –¥–æ–∑–≤–æ–ª–µ–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Å–∫–æ—Ç—á, –¥—Ä—ñ—Ç –∞–±–æ –∫–∞—Ä—Ç–æ–Ω –¥–ª—è —Ç–∏–º—á–∞—Å–æ–≤–æ–≥–æ –∫—Ä—ñ–ø–ª–µ–Ω–Ω—è —Ç—Ä—É–±–∏ –Ω–∞ –ª—ñ–Ω—ñ—ó —Ä–æ–∑–ª–∏–≤—É?",
                a: ["–¢–∞–∫, —è–∫—â–æ —Ü–µ —à–≤–∏–¥–∫–æ", "–ù—ñ, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤, —â–æ –Ω–µ –º–∏—é—Ç—å—Å—è —ñ –º–æ–∂—É—Ç—å –ø–æ—Ç—Ä–∞–ø–∏—Ç–∏ –≤ –ø—Ä–æ–¥—É–∫—Ç, –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ", "–¢–∞–∫, –¥–æ –∫—ñ–Ω—Ü—è –∑–º—ñ–Ω–∏"],
                correct: 1
            },
            {
                q: "–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≤—ñ–¥—Ö–æ–¥–∞–º–∏: –Ø–∫ —à–≤–∏–¥–∫–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–¥–∞–ª—è—Ç–∏ –≤–∏—Ä–æ–±–Ω–∏—á—ñ –≤—ñ–¥—Ö–æ–¥–∏ –∑ –∑–æ–Ω–∏ –ø—Ä–∏–≥–æ—Ç—É–≤–∞–Ω–Ω—è —Å–æ—É—Å—ñ–≤?",
                a: ["–í –∫—ñ–Ω—Ü—ñ —Ç–∏–∂–Ω—è", "–†–µ–≥—É–ª—è—Ä–Ω–æ, –Ω–µ –¥–æ–ø—É—Å–∫–∞—é—á–∏ –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –ø–µ—Ä–µ—Ö—Ä–µ—Å–Ω–æ–≥–æ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è", "–í –∫—ñ–Ω—Ü—ñ –∑–º—ñ–Ω–∏"],
                correct: 1
            },
            {
                q: "–ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è (FIFO/FEFO): –Ø–∫—É –ø–∞–ª–µ—Ç—É –∑ —Ç–æ–º–∞—Ç–Ω–æ—é –ø–∞—Å—Ç–æ—é –≤–∏ –≤—ñ–∑—å–º–µ—Ç–µ –ø–µ—Ä—à–æ—é?",
                a: ["–¢—É, —â–æ —Å—Ç–æ—ó—Ç—å –±–ª–∏–∂—á–µ", "–¢—É, —É —è–∫–æ—ó —Ä–∞–Ω—ñ—à–µ –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è —Ç–µ—Ä–º—ñ–Ω –ø—Ä–∏–¥–∞—Ç–Ω–æ—Å—Ç—ñ", "–¢—É, —è–∫–∞ –Ω–æ–≤—ñ—à–∞"],
                correct: 1
            },
            {
                q: "–•—ñ–º—ñ—á–Ω–∞ –±–µ–∑–ø–µ–∫–∞: –î–µ –ø–æ–≤–∏–Ω–Ω—ñ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—è –º–∏—é—á—ñ —Ç–∞ –¥–µ–∑—ñ–Ω—Ñ—ñ–∫—É—é—á—ñ –∑–∞—Å–æ–±–∏?",
                a: ["–ù–∞ –ø—ñ–¥–ª–æ–∑—ñ –≤ —Ü–µ—Ö—É", "–£ –∑–∞–∫—Ä–∏—Ç—ñ–π —à–∞—Ñ—ñ/–ø—Ä–∏–º—ñ—â–µ–Ω–Ω—ñ –∑ –æ–±–º–µ–∂–µ–Ω–∏–º –¥–æ—Å—Ç—É–ø–æ–º, –æ–∫—Ä–µ–º–æ –≤—ñ–¥ –ø—Ä–æ–¥—É–∫—Ç—ñ–≤", "–ü—ñ–¥ —Ä–æ–±–æ—á–∏–º —Å—Ç–æ–ª–æ–º"],
                correct: 1
            },
            {
                q: "–ú–∞—Ä–∫—É–≤–∞–Ω–Ω—è (–î–∞—Ç–∞/–ü–∞—Ä—Ç—ñ—è): –í–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç–µ –µ—Ç–∏–∫–µ—Ç–∫—É. –Ø–∫–∏–π —Ñ–æ—Ä–º–∞—Ç —î —î–¥–∏–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º –∑–≥—ñ–¥–Ω–æ –∑ –Ω–∞—à–∏–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º?",
                a: ["00.00.0000 / –ü–∞—Ä—Ç—ñ—è 0000", "–ü–∞—Ä—Ç—ñ—è:0000, –î–∞—Ç–∞ –≤–∂–∏—Ç–∏ –¥–æ: 00.00.0000", "–î–∞—Ç–∞ –≤–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—è: 00.00.0000, –î–∞—Ç–∞ –≤–∂–∏—Ç–∏ –¥–æ: 00.00.0000"],
                correct: 1
            },
            {
                q: "–ö–æ–Ω—Ç—Ä–æ–ª—å —Å—Ç–æ—Ä–æ–Ω–Ω—ñ—Ö –ø—Ä–µ–¥–º–µ—Ç—ñ–≤ (–±–µ–∑ –º–µ—Ç–∞–ª–æ–¥–µ—Ç–µ–∫—Ç–æ—Ä–∞): –í–∏ –ø–æ–º—ñ—Ç–∏–ª–∏, —â–æ –ø–ª–∞—Å—Ç–∏–∫–æ–≤–∞ –ª–æ–ø–∞—Ç–∫–∞ —Ç—Ä–æ—à–∫–∏ –Ω–∞–¥—â–µ—Ä–±–ª–µ–Ω–∞. –í–∞—à—ñ –¥—ñ—ó?",
                a: ["–ü—Ä–∞—Ü—é–≤–∞—Ç–∏ –¥–∞–ª—ñ, —à–º–∞—Ç–æ–∫ –º–∞–ª–∏–π", "–ó—É–ø–∏–Ω–∏—Ç–∏ —Ä–æ–±–æ—Ç—É, –ø–æ–≤—ñ–¥–æ–º–∏—Ç–∏ –º–∞–π—Å—Ç—Ä–∞, –∑–∞–±–ª–æ–∫—É–≤–∞—Ç–∏ –ø—Ä–æ–¥—É–∫—Ü—ñ—é (—Ä–∏–∑–∏–∫ —Ñ—ñ–∑–∏—á–Ω–æ–≥–æ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è)", "–°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–Ω–∞–π—Ç–∏ —à–º–∞—Ç–æ–∫ –≤ —á–∞–Ω—ñ"],
                correct: 1
            },
            {
                q: "–í–æ–¥–∞: –ß–∏ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–µ –ø—ñ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—É –≤–æ–¥—É –¥–ª—è –æ–ø–æ–ª—ñ—Å–∫—É–≤–∞–Ω–Ω—è –æ–±–ª–∞–¥–Ω–∞–Ω–Ω—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ?",
                a: ["–¢–∞–∫, —è–∫—â–æ –ø–æ—Ç—ñ–º –ø—Ä–æ—Å—É—à–∏—Ç–∏", "–ù—ñ, —Ç—ñ–ª—å–∫–∏ –≤–æ–¥—É –ø—ñ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—É –ø—ñ—Å–ª—è –•–í–û", "–ú–æ–∂–Ω–∞, —è–∫—â–æ —Ü–µ –Ω–µ —Ñ—ñ–Ω–∞–ª—å–Ω–µ –æ–ø–æ–ª—ñ—Å–∫—É–≤–∞–Ω–Ω—è"],
                correct: 1
            },
            {
                q: "–í—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ: –£ —Ü–µ—Ö –∑–∞—Ö–æ–¥–∏—Ç—å –ø—ñ–¥—Ä—è–¥–Ω–∏–∫ —Ä–µ–º–æ–Ω—Ç—É–≤–∞—Ç–∏ —Å–≤—ñ—Ç–ª–æ. –ß–∏ –ø–æ–≤–∏–Ω–µ–Ω –≤—ñ–Ω –∑–∞–ø–æ–≤–Ω—é–≤–∞—Ç–∏ –∞–Ω–∫–µ—Ç—É –∑–¥–æ—Ä–æ–≤'—è?",
                a: ["–ù—ñ, –≤—ñ–Ω –Ω–µ —Ç–æ—Ä–∫–∞—î—Ç—å—Å—è –ø—Ä–æ–¥—É–∫—Ç—ñ–≤", "–¢–∞–∫, –ø—Ä–∞–≤–∏–ª–∞ FSSC —Å—Ç–æ—Å—É—é—Ç—å—Å—è –≤—Å—ñ—Ö –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ–≤", "–¢—ñ–ª—å–∫–∏ —è–∫—â–æ –≤—ñ–Ω –ø–µ—Ä—à–∏–π —Ä–∞–∑"],
                correct: 1
            },
            {
                q: "–ü—Ä–æ—Å—Ç–µ–∂—É–≤–∞–Ω—ñ—Å—Ç—å: –í–∏ –∑–º—ñ—à–∞–ª–∏ –¥–≤–∞ –∑–∞–ª–∏—à–∫–∏ –æ–¥–Ω—ñ—î—ó —Å–ø–µ—Ü—ñ—ó –∑ —Ä—ñ–∑–Ω–∏–º–∏ –Ω–æ–º–µ—Ä–∞–º–∏ –ø–∞—Ä—Ç—ñ–π –≤ –æ–¥–Ω—É —î–º–Ω—ñ—Å—Ç—å. –¶–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ?",
                a: ["–¢–∞–∫, –µ–∫–æ–Ω–æ–º–∏–º–æ –º—ñ—Å—Ü–µ", "–ù—ñ, –≤—Ç—Ä–∞—á–∞—î—Ç—å—Å—è –ø—Ä–æ—Å—Ç–µ–∂—É–≤–∞–Ω—ñ—Å—Ç—å –ø–∞—Ä—Ç—ñ—ó. –ü–æ—Ç—Ä—ñ–±–Ω–æ —Ñ—ñ–∫—Å—É–≤–∞—Ç–∏ –∑–º—ñ—à—É–≤–∞–Ω–Ω—è –∞–±–æ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –æ–∫—Ä–µ–º–æ", "–¢–∞–∫, —è–∫—â–æ —Å–ø–µ—Ü—ñ—è –æ–¥–Ω–∞–∫–æ–≤–∞"],
                correct: 1
            },
            {
                q: "–ü–æ–≤—Ç–æ—Ä–Ω–∞ –ø–µ—Ä–µ—Ä–æ–±–∫–∞: –Ø–∫ –º–∞—Ä–∫—É–≤–∞—Ç–∏ —Å–æ—É—Å, —è–∫–∏–π –π–¥–µ –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω—É –ø–µ—Ä–µ—Ä–æ–±–∫—É?",
                a: ["–ù—ñ—è–∫, –º–∏ –π–æ–≥–æ —Ç–∞–∫ –¥–æ–¥–∞–º–æ", "–ß—ñ—Ç–∫–µ –º–∞—Ä–∫—É–≤–∞–Ω–Ω—è: –ù–∞–∑–≤–∞, –î–∞—Ç–∞, '–ù–ê –ü–ï–†–ï–í–ê–†–ö–£'", "–ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—Å–∞—Ç–∏ –Ω–æ–º–µ—Ä –∑–∞–≤–¥–∞–Ω–Ω—è/–ø–∞—Ä—Ç—ñ—ó"],
                correct: 1
            },
            {
                q: "–ü—Ä–∏–±–∏—Ä–∞–Ω–Ω—è —Ä–æ–∑–ª–∏–≤—ñ–≤: –ù–∞ –ø—ñ–¥–ª–æ–≥—É —Ä–æ–∑–ª–∏–ª–∞—Å—è –æ–ª—ñ—è. –ß–æ–º—É —Ü–µ –Ω–µ–±–µ–∑–ø–µ—á–Ω–æ –∫—Ä—ñ–º —Ä–∏–∑–∏–∫—É –ø–æ—Å–ª–∏–∑–Ω—É—Ç–∏—Å—è?",
                a: ["–¶–µ –Ω–µ–±–µ–∑–≤–µ—á–Ω–æ –¥–ª—è –Ω–∞–≤–∫–æ–ª–∏—à–Ω—å–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞", "–û–ª—ñ—è –≤–∞–∂–∫–æ –∑–º–∏–≤–∞—î—Ç—å—Å—è —ñ —î —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ–º –¥–ª—è —Ä–æ–∑–≤–∏—Ç–∫—É –±–∞–∫—Ç–µ—Ä—ñ–π —Ç–∞ –ø–ª—ñ—Å–Ω—è–≤–∏", "–¶–µ –≤—Ç—Ä–∞—Ç–∞ –≥—Ä–æ—à–µ–π"],
                correct: 1
            },
            {
                q: "–ö–∞–ª—ñ–±—Ä—É–≤–∞–Ω–Ω—è: –í–∏ –≤–ø—É—Å—Ç–∏–ª–∏ –≤–∏–º—ñ—Ä—é–≤–∞–ª—å–Ω–∏–π –ø—Ä–∏–¥–∞–¥ –Ω–∞ –ø—ñ–¥–ª–æ–≥—É. –ß–∏ –º–æ–∂–Ω–∞ –Ω–∏–º –¥–∞–ª—ñ –º—ñ—Ä—è—Ç–∏?",
                a: ["–¢–∞–∫, —è–∫—â–æ —Å–∫–ª–æ —Ü—ñ–ª–µ", "–ù—ñ, –≤—ñ–Ω –º—ñ–≥ –∑–±–∏—Ç–∏—Å—è. –ô–æ–≥–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏/–∫–∞–ª—ñ–±—Ä—É–≤–∞—Ç–∏", "–¢–∞–∫, —è–∫—â–æ –≤—ñ–Ω –≤–º–∏–∫–∞—î—Ç—å—Å—è"],
                correct: 1
            },
            {
                q: "–í–µ–Ω—Ç–∏–ª—è—Ü—ñ—è: –ß–æ–º—É –≤—ñ–∫–Ω–∞/–ø—Ä–æ–µ–º–∏ –≤ —Ü–µ—Ö—É, —â–æ –≤—ñ–¥–∫—Ä–∏–≤–∞—é—Ç—å—Å—è, –ø–æ–≤–∏–Ω–Ω—ñ –º–∞—Ç–∏ –∑–∞—Ö–∏—Å–Ω—ñ —Å—ñ—Ç–∫–∏/—à—Ç–æ—Ä–∏?",
                a: ["–©–æ–± –Ω–µ –≤—Ç—ñ–∫–∞–ª–∏ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∏", "–î–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –ø–æ—Ç—Ä–∞–ø–ª—è–Ω–Ω—é –∫–æ–º–∞—Ö —Ç–∞ —à–∫—ñ–¥–Ω–∏–∫—ñ–≤", "–î–ª—è –∫—Ä–∞—Å–∏"],
                correct: 1
            },
            {
                q: "–Ü–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞: –í–∏ –ø–æ–±–∞—á–∏–ª–∏ –ø–ª—ñ—Å–Ω—è–≤—É –Ω–∞ –≥–µ—Ä–º–µ—Ç–∏–∫—É –±—ñ–ª—è –º–∏–π–∫–∏. –í–∞—à—ñ –¥—ñ—ó?",
                a: ["–ó–º–∏—Ç–∏ –≤–æ–¥–æ—é", "–ü–æ–¥–∞—Ç–∏ –∑–∞—è–≤–∫—É –Ω–∞ –∑–∞–º—ñ–Ω—É –≥–µ—Ä–º–µ—Ç–∏–∫–∞, —Ü–µ –¥–∂–µ—Ä–µ–ª–æ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è", "–ù–µ –∑–≤–µ—Ä—Ç–∞—Ç–∏ —É–≤–∞–≥–∏"],
                correct: 1
            }
        ];

        // STATE
        let currentQIndex = 0;
        let score = 0;
        let userName = "";
        let userLog = []; 

        // REFS
        const stepLogin = document.getElementById('step-login');
        const stepQuiz = document.getElementById('step-quiz');
        const stepResult = document.getElementById('step-result');
        const nameInput = document.getElementById('employeeName');
        const qText = document.getElementById('question-text');
        const optContainer = document.getElementById('options-container');
        const nextBtn = document.getElementById('next-btn');
        const progressBar = document.getElementById('progress-bar');
        const qCurrentSpan = document.getElementById('q-current');
        const qTotalSpan = document.getElementById('q-total');

        // FUNCTIONS
        function startTest() {
            const name = nameInput.value.trim();
            if (!name) {
                alert("–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å —Å–≤–æ—î –ü—Ä—ñ–∑–≤–∏—â–µ —Ç–∞ –Ü–º'—è");
                return;
            }
            userName = name;
            stepLogin.classList.add('hidden');
            stepQuiz.classList.remove('hidden');
            renderQuestion();
        }

        function renderQuestion() {
            const q = questions[currentQIndex];
            qCurrentSpan.innerText = currentQIndex + 1;
            qTotalSpan.innerText = questions.length;
            
            const pct = ((currentQIndex) / questions.length) * 100;
            progressBar.style.width = `${pct}%`;

            qText.innerText = q.q;
            optContainer.innerHTML = '';
            nextBtn.disabled = true;
            nextBtn.classList.add('bg-gray-300', 'cursor-not-allowed');
            nextBtn.classList.remove('bg-emerald-600', 'hover:bg-emerald-700', 'text-white');
            nextBtn.innerText = currentQIndex === questions.length - 1 ? "–ó–∞–≤–µ—Ä—à–∏—Ç–∏ —Ç–µ—Å—Ç" : "–î–∞–ª—ñ";

            q.a.forEach((optText, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn w-full text-left p-4 rounded-xl text-lg mb-2 relative';
                btn.innerText = optText;
                btn.onclick = () => selectOption(index, btn);
                optContainer.appendChild(btn);
            });
        }

        let selectedOptionIndex = null;

        function selectOption(index, btnElement) {
            document.querySelectorAll('.option-btn').forEach(b => {
                b.classList.remove('selected');
                b.classList.remove('bg-emerald-100');
            });
            btnElement.classList.add('selected');
            selectedOptionIndex = index;
            nextBtn.disabled = false;
            nextBtn.classList.remove('bg-gray-300', 'cursor-not-allowed', 'text-gray-500');
            nextBtn.classList.add('bg-emerald-600', 'hover:bg-emerald-700', 'text-white');
        }

        function nextQuestion() {
            const correctIndex = questions[currentQIndex].correct;
            const isCorrect = (selectedOptionIndex === correctIndex);
            
            if (isCorrect) score++;

            userLog.push({
                qIndex: currentQIndex,
                userAnswerIndex: selectedOptionIndex,
                isCorrect: isCorrect
            });
            
            currentQIndex++;

            if (currentQIndex < questions.length) {
                renderQuestion();
            } else {
                showResults();
            }
        }

        // 1. Generate FULL Detailed Report for SCREEN QR (Local JS handles this fine)
        function generateFullReport() {
            let text = `–ó–í–Ü–¢ (–î–ï–¢–ê–õ–Ü–ó–ê–¶–Ü–Ø)\n${userName}\n${new Date().toLocaleString('uk-UA')}\n–†–µ–∑: ${score}/${questions.length}\n\n`;
            
            userLog.forEach((log, index) => {
                const q = questions[log.qIndex];
                const mark = log.isCorrect ? "‚úÖ" : "‚ùå";
                const qShort = q.q.length > 30 ? q.q.substring(0, 30) + "..." : q.q;
                const aShort = q.a[log.userAnswerIndex].length > 20 ? q.a[log.userAnswerIndex].substring(0, 20) + "..." : q.a[log.userAnswerIndex];
                text += `${index + 1}. ${mark} ${qShort} -> ${aShort}\n`;
            });
            return text;
        }

        // 2. Generate COMPACT ERRORS REPORT for EMAIL LINK
        // This makes the URL much shorter because we remove full text of questions.
        function generateCompactErrorReport() {
            let text = `–ü–Ü–ë: ${userName}\n–†–µ–∑: ${score}/${questions.length}\n`;
            
            let errorCount = 0;
            userLog.forEach((log, index) => {
                if (!log.isCorrect) {
                    errorCount++;
                    // Only Question Index and Short Answer to save space
                    const aShort = questions[log.qIndex].a[log.userAnswerIndex].substring(0, 15);
                    text += `\nX –ü–∏—Ç.${index + 1}: ${aShort}...`;
                }
            });

            if (errorCount === 0) text += "–í—Å–µ –≤—ñ—Ä–Ω–æ!";
            return text;
        }

        // Generate Email Body
        function generateEmailBody(passed, percentage, qrLink) {
             let bodyText = `–ó–í–Ü–¢ –¢–ï–°–¢–£–í–ê–ù–ù–Ø (FSSC 22000)\n`;
            bodyText += `–ü—Ä–∞—Ü—ñ–≤–Ω–∏–∫: ${userName}\n`;
            bodyText += `–î–∞—Ç–∞: ${new Date().toLocaleString('uk-UA')}\n`;
            bodyText += `–†–µ–∑—É–ª—å—Ç–∞—Ç: ${score} –∑ 26 (${percentage}%)\n`;
            bodyText += `–°—Ç–∞—Ç—É—Å: ${passed ? '‚úÖ –°–ö–õ–ê–î–ï–ù–û (–ë–û–ù–£–°)' : '‚ùå –ù–ï –°–ö–õ–ê–î–ï–ù–û'}\n`;
            bodyText += `--------------------------------\n`;
            bodyText += `–ü–û–°–ò–õ–ê–ù–ù–Ø –ù–ê –ó–í–Ü–¢ –ü–û–ú–ò–õ–û–ö (QR):\n`;
            bodyText += `${qrLink}\n`;
            bodyText += `(–ü–æ–≤–Ω–∏–π –∑–≤—ñ—Ç —Ç–∞–∫–æ–∂ –¥–æ—Å—Ç—É–ø–Ω–∏–π –Ω–∞ –µ–∫—Ä–∞–Ω—ñ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞)`;
            
            return bodyText;
        }

        function showResults() {
            stepQuiz.classList.add('hidden');
            stepResult.classList.remove('hidden');

            const scoreVal = document.getElementById('score-val');
            const percentageVal = document.getElementById('percentage-val');
            const iconResult = document.getElementById('icon-result');
            const titleResult = document.getElementById('title-result');
            const msgResult = document.getElementById('msg-result');
            const emailBtn = document.getElementById('email-btn');

            scoreVal.innerText = score;
            const percentage = Math.round((score / questions.length) * 100);
            percentageVal.innerText = `${percentage}% —É—Å–ø—ñ—Ö—É`;

            const passed = score >= 24;

            if (passed) {
                iconResult.innerText = "üèÜ";
                titleResult.innerText = "–í—ñ—Ç–∞—î–º–æ!";
                titleResult.className = "text-3xl font-bold mb-2 text-emerald-600";
                msgResult.innerText = "–í–∏ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏–ª–∏ –∫–≤–∞–ª—ñ—Ñ—ñ–∫–∞—Ü—ñ—é —Ä—ñ–≤–Ω—è FSSC 22000! –ë–æ–Ω—É—Å –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ.";
            } else {
                iconResult.innerText = "‚ö†Ô∏è";
                titleResult.innerText = "–¢–µ—Å—Ç –Ω–µ —Å–∫–ª–∞–¥–µ–Ω–æ";
                titleResult.className = "text-3xl font-bold mb-2 text-orange-600";
                msgResult.innerText = `–ù–µ–æ–±—Ö—ñ–¥–Ω–∏–π –º—ñ–Ω—ñ–º—É–º: 24 –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. –£ –≤–∞—Å ${score}. –ü–æ–≤—Ç–æ—Ä—ñ—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏ FSSC 22000.`;
            }

            // 1. Display FULL QR on screen (Detailed)
            const fullReport = generateFullReport();
            const qrcodeContainer = document.getElementById("qrcode");
            qrcodeContainer.innerHTML = "";
            try {
                new QRCode(qrcodeContainer, {
                    text: fullReport,
                    width: 200,
                    height: 200,
                    colorDark : "#000000",
                    colorLight : "#ffffff",
                    correctLevel : QRCode.CorrectLevel.L
                });
            } catch(e) {
                console.error("QR gen error:", e);
                qrcodeContainer.innerText = "–ü–æ–º–∏–ª–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó QR.";
            }

            // 2. Generate COMPACT LINK for Email (To fit in URL)
            // Using the compact report function
            const compactReport = generateCompactErrorReport();
            const qrApiUrl = `https://api.qrserver.com/v1/create-qr-code/?size=300x300&charset-source=UTF-8&data=${encodeURIComponent(compactReport)}`;

            // 3. Prepare Email Body
            const emailBody = generateEmailBody(passed, percentage, qrApiUrl);

            // Setup Email Button
            const recipients = 'Dyndarnastia@gmail.com,Buznitskiy7@gmail.com';
            const subject = encodeURIComponent(`–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç—É FSSC 22000: ${userName}`);
            
            emailBtn.href = `mailto:${recipients}?subject=${subject}&body=${encodeURIComponent(emailBody)}`;
        }
    </script>
</body>
</html>
